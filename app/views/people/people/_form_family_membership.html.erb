<% if can?(:create, FamilyMembership) %>
  <div class="list-group mb-2">
    <%= render 'shared/list_group_header', title: 'Add to Family' %>

    <div class="list-group-item" id="family-picker">
      <div class="my-sm">
        <%= f.select :family_ids, [], { include_blank: true }, class: 'form-control',
                     data: { selectpicker: true, placeholder: 'Choose a Family', :'allow-clear' => true,
                             ajax: families_path(not: @person.family_memberships.pluck(:family_id).join(',')),
                             new: "Start new family", template: :family } %>
        <div id="person_family_name">
          <%= f.text_field :family_name, class: 'form-control mt-1', placeholder: 'Family name', autocapitalize: :words, id: 'person_family_name_field' %>
          <%= f.text_field :family_address1, class: 'form-control mt-sm', placeholder: 'Address',  autocapitalize: :words %>
          <%= f.text_field :family_address2, class: 'form-control mt-sm', placeholder: 'Town',     autocapitalize: :words %>
          <%= f.text_field :family_postcode, class: 'form-control mt-sm', placeholder: 'Postcode', autocapitalize: :words %>
          <%= f.text_field :family_country,  class: 'form-control mt-sm', placeholder: 'Country',  autocapitalize: :words %>
        </div>
      </div>
    </div>
  </div>
<% end %>
